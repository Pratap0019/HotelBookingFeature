<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Homepage - Pratap Hotels</title>

    <!-- Bootstrap CSS -->
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
            crossorigin="anonymous">

    <!-- Bootstrap JS Bundle -->
    <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            crossorigin="anonymous"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        body {
            background-color: #dcdcdc;
            font-family: 'Poppins', sans-serif;
            padding-top: 130px;
        }

        .header {
            background-image: url('https://images.unsplash.com/photo-1505761671935-60b3a7427bad?auto=format&fit=crop&w=1500&q=80');
            background-size: cover;
            background-position: center;
            position: fixed;
            top: 0; left: 0;
            width: 100%;
            z-index: 1000;
            height: 120px;
            display: flex;
            align-items: center;
            padding: 15px 25px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .header-content {
            background: rgba(255, 255, 255, 0.75);
            border-radius: 12px;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header-content img {
            width: 50px;
            height: 50px;
        }

        .form-section {
            max-width: 700px;
            margin: 40px auto;
            background-image: url('https://images.unsplash.com/photo-1502602898657-3e91760cbb34?auto=format&fit=crop&w=1200&q=80');
            background-size: cover;
            background-position: center;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            position: relative;
        }

        .form-section::before {
            content: "";
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(50, 50, 50, 0.2);
            border-radius: 15px;
        }

        .message {
            margin-top: 15px;
            font-weight: 600;
            color: #fff;
            text-align: center;
            background: rgba(0,0,0,0.6);
            padding: 8px 12px;
            border-radius: 8px;
        }

        .bill-section {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0,0,0,0.7);
            border-radius: 10px;
            border: 1px solid #333;
            color: #fff;
        }

        .form-section form {
            position: relative;
            z-index: 1;
        }

        .form-section h4 {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            color: #d35400;
            font-weight: 600;
        }
    </style>
</head>

<body>
<!-- Header -->
<div class="header">
    <div class="container-fluid">
        <div class="row g-3 align-items-center">
            <div class="col-sm-3">
                <div class="header-content">
                    <div>
                        <h2 class="mb-0">PRATAP HOTELS</h2>
                        <p class="mb-0">Where Comfort Meets Royalty</p>
                    </div>
                </div>
            </div>
            <div class="col-sm-9 text-end">
                <a href="/adminlogin">
                    <img src="https://cdn.pixabay.com/photo/2013/07/13/13/38/man-161282__340.png"
                         alt="admin-logo" width="40" height="40"/>
                </a>
                <p style="font-size: 0.9rem; font-weight: 500; color:#111;">Admin</p>
            </div>
        </div>
    </div>
</div>

<!-- Booking Form -->
<div class="form-section">
    <form th:action="@{/searchRooms}" method="post">
        <h4 class="text-center">Book Your Stay</h4>
        <br>

        <div class="mb-3">
            <label for="checkIn" class="form-label">Check-In Date</label>
            <input type="date" class="form-control" id="checkIn" name="checkIn" required>
        </div>

        <div class="mb-3">
            <label for="checkOut" class="form-label">Check-Out Date</label>
            <input type="date" class="form-control" id="checkOut" name="checkOut" required>
        </div>

        <div class="mb-3">
            <label for="guestCount" class="form-label">Guests</label>
            <input type="number" class="form-control" id="guestCount" name="guestCount" min="1" value="1" required>
        </div>

        <div class="mb-3">
            <label for="roomType" class="form-label">Room Type</label>
            <select class="form-select" id="roomType" name="roomType" required>
                <option value="">Select a room type</option>
                <option value="single">Single</option>
                <option value="double">Double</option>
                <option value="suite">Suite</option>
            </select>
        </div>

        <div class="d-grid gap-2">
            <button type="submit" class="btn btn-dark">Search Room</button>
        </div>
    </form>

    <div th:if="${bookingMessage}" class="message">
        <p th:text="${bookingMessage}"></p>
    </div>
</div>

<!-- Calculate Bill Form -->
<div class="form-section">
    <form th:action="@{/calculateBill}" th:object="${bookingForm}" method="post">
        <h4 class="text-center">Calculate Price</h4>
        <br>

        <!-- Room Selection -->
        <div class="mb-3">
            <label for="roomNumber" class="form-label">Room Number</label>
            <select class="form-select" th:field="*{roomNumber}" required>
                <option value="" disabled>Select a room</option>
                <option th:each="room : ${availableRooms}"
                        th:value="${room.roomNumber}"
                        th:text="${'Room ' + room.roomNumber + ' (' + room.roomType + ')'}">
                </option>
            </select>
        </div>

        <!-- Days Stayed -->
        <div class="mb-3">
            <label for="daysStayed" class="form-label">Days Stayed</label>
            <input type="number" class="form-control" th:field="*{daysStayed}" min="1" required/>
        </div>

        <!-- Extras -->
        <div class="mb-3" th:if="${bookingForm.roomNumber != null}">
            <label class="form-label">Extras</label><br>
            <div class="form-check form-check-inline"
                 th:each="extra : ${T(com.pratap.hotel.model.Extras).values()}">
                <input class="form-check-input" type="checkbox"
                       th:field="*{extras}" th:value="${extra}"
                       th:disabled="${!#lists.contains(
                         availableRooms.?[roomNumber == bookingForm.roomNumber][0].extras, extra
                       )}"/>
                <label class="form-check-label" th:text="${extra}"></label>
            </div>
        </div>

        <!-- Pet Weight -->
        <div class="mb-3" th:if="${bookingForm.roomNumber != null}">
            <label class="form-label">Pet</label>
            <input type="number" class="form-control" th:field="*{petWeight}"
                   placeholder="Pet weight in kg (leave empty if none)"/>
        </div>

        <div class="d-grid gap-2">
            <button type="submit" class="btn btn-dark">Calculate Bill</button>
        </div>
    </form>

    <!-- Bill Result -->
    <div th:if="${bill}" class="bill-section mt-4">
        <h5>Bill Summary</h5>
        <p><strong>Total Amount:</strong> INR <span th:text="${bill.totalAmount}"></span></p>
        <ul>
            <li th:each="entry : ${bill.breakdown}">
                <span th:text="${entry.key}"></span>: INR <span th:text="${entry.value}"></span>
            </li>
        </ul>
    </div>
</div>

</body>
</html>
